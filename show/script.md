Доброе утро! Сейчас речь пойдёт о так называемой атаке Spectre. Наверняка многие из Вас слышали о ней или о схожей атаке Meltdown. Spectre основан на некоторых уязвимостях в устройстве современных процессоров.

Первая часть доклада будет содержать теоретическое объяснение этих уязвимостей. Во второй части будет небольшая демонстрация и пояснение кода. Для лучшего понимания давайте кратко рассмотрим основные концепции.

Как вы знаете, процессор - это мозг всех наших устройств.
Процессор отвечает за выполнение всех инструкций, которые даёт наша операционная система и наши программы. И, конечно же, важным параметром процессора является скорость его работы.

Также важно сказать пару слов о памяти.
В наших устройствах есть два типа памяти: основная системная память, также называемая оперативной памятью, и кэш-память в процессоре. Работающему процессору необходимо постоянно считывать и записывать данные из основной памяти.
Однако обращение к RAM намного медленнее, чем скорость процессора, поэтому люди добавили небольшой кэш на сам процессор для хранения данных, с которыми он работает. Каждый раз, когда процессор что-то достаёт из основной памяти, он копирует это значение в кэш и в следующий раз прочитает информацию уже из кэша с большей скоростью.

Стремясь улучшить быстродействие процессора, архитекторы процессоров однажды пришли к так назваемому "спекулятивному" исполнению. Что же это такое? Представьте, что у вас есть какое-то условие в коде, зависящее от данных, которые лежат в RAM.(todo) Вместо того чтобы ждать долгого обращения к основной памяти, процессор попытается наперёд произвести операцию, которая стоит под условием. После чего получит результат условия и, в зависимости от него, отбросит или сохранит уже вычисленный результат.

Прекрасная технология, но есть один нюанс. Спекулятивно вычисляя результат, процессор на hardware уровне обращается к памяти, которая может быть недоступна со стороны софта. Это открывает целый спектр атак типа Spectre.

Чуть подробнее расскажу о варианте, который был нами реализован.
Существует так называемая timing attack, которая вместе со спектром образует опасное оружие. 

Представьте, что вы аналитик, который измеряет время доступа процессора к некоторой памяти. Как уже отмечалось, если процессор недавно уже обращался к запрашиваемому участку памяти, то данные будут храниться в кэше, значит время доступа к ним будет на порядок меньше, чем к остальным.

Теперь, если Вы не обычный аналитик, а злоумышленник, Вы можете использовать уязвимость Spectre. Вы просите программу обратиться к памяти, которая Вам не доступна, процессор спекулятивно вычисляет результат, но не выдаёт его, потому что не Вам положено!! Однако при помощи timing attack можно понять, какая область памяти оказалась в кэшах в процессе спекулятивного исполнения, и достать недоступные данные по физическим адресам. Забавно, что это почти невозможно отследить.
